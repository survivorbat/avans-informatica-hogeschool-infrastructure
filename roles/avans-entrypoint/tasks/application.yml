---
- name: "Ensure {{ project_dir }}"
  file:
    state: directory
    path: "{{ project_dir }}"
    owner: "{{ default_user.name }}"
    group: "{{ default_group.name }}"

- name: "Ensure files in {{ project_dir }}"
  copy:
    src: "{{ local_project_dir }}"
    dest: "{{ project_dir }}/.."
    owner: "{{ default_user.name }}"
    group: "{{ default_group.name }}"
    force: yes

- name: "Restart Docker containers from {{ project_name }} with files in {{ project_dir }}"
  docker_service:
    state: present
    restarted: yes
    project_name: "{{ project_name }}"
    project_src: "{{ project_dir }}"
    files: "{{ project_docker_files }}"